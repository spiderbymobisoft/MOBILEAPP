{"version":3,"sources":["../../src/pages/new-street/new-street.module.ts","../../src/pages/new-street/new-street.ts"],"names":[],"mappings":"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","file":"23.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { NewStreetPage } from './new-street';\n\n@NgModule({\n  declarations: [\n    NewStreetPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(NewStreetPage),\n  ],\n})\nexport class NewStreetPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/new-street/new-street.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\nimport { Geolocation } from '@ionic-native/geolocation';\nimport { Store } from '../../app.services/store/data.store';\nimport { SharedServices } from '../../app.services/library/shared.services';\nimport { NigeriaStatesService } from '../../app.services/locations/nigeria.states.service';\nimport { FormConfig } from '../../app.services/store/form.config';\n\n@IonicPage()\n@Component({\n  selector: 'page-new-street',\n  templateUrl: 'new-street.html',\n})\nexport class NewStreetPage {\n\n  public payload: any = {\n    record_id: '',\n    document_owner: '',\n    street: {\n      street_id: '',\n      gis_id: '',\n      street_name: '',\n      street_furniture: [],\n      road_type: '',\n      road_condition: '',\n      road_carriage: '',\n      road_feature: [],\n      refuse_disposal: '',\n      drainage: '',\n      electricity: '',\n      area: '',\n      location: '',\n      lga: '',\n      state: '',\n      country: 'Nigeria'\n    },\n    location: {\n      type: 'Point',\n      coordinates: {\n        latitude: 0,\n        longitude: 0\n      },\n      whatthreewords: ''\n    },\n    street_photos: [],\n    enumerator: {\n      id: '',\n      firstname: '',\n      lastname: '',\n      email: '',\n      telephone: ''\n    },\n    signature: ''\n  }\n\n  public nigeriaStates: any[] = [];\n  public stateCities: any[] = [];\n  private user: any;\n\n  constructor(public navCtrl: NavController, public navParams: NavParams, public formConfig: FormConfig,\n    private store: Store, private ss: SharedServices, private nss: NigeriaStatesService,\n    private geolocation: Geolocation) {\n      this.dataInit();\n  }\n\n  dataInit(){\n    this.store.GET_USER().then(data=>{\n      this.user = data;\n      this.payload.record_id = this.ss.GENERATE_RECORD_ID();\n    });\n   \n  }\n\n  ionViewDidLoad() {\n    this.getLocations();\n  }\n\n  getLocations() {\n    this.nss.getJSON().subscribe(data => {\n      let _data = data;\n      _data.forEach(_d => {\n        this.nigeriaStates.push(_d.state.name);\n      });\n    });\n  }\n\n  loadCity(e) {\n    this.stateCities = [];\n    this.nss.getJSON().subscribe(data => {\n      let _data = data;\n      _data.forEach(_d => {\n        if (_d.state.name === e) {\n          _d.state.locals.forEach(local => {\n            this.stateCities.push(local);\n          });\n        }\n      });\n    });\n  }\n\n  isFormValid(): boolean {\n    if(\n      !this.payload.street.street_name || \n      !this.payload.street.area || \n      !this.payload.street.location || \n      !this.payload.street.lga || \n      !this.payload.street.state ||\n      !this.payload.street.road_type ||\n      this.payload.street.street_furniture.length === 0 ||\n      !this.payload.street.road_condition ||\n      !this.payload.street.road_carriage ||\n      this.payload.street.road_feature.length === 0 ||\n      !this.payload.street.refuse_disposal ||\n      !this.payload.street.drainage ||\n      !this.payload.street.electricity\n    ){\n      return false\n    }else{\n      return true\n    }\n  }\n\n  save() {\n    if (!this.isFormValid()) {\n      this.ss.swalAlert('Data Service', 'All fields are required. Please try again', 'error');\n    } else {\n      this.processSave();\n    }\n\n  }\n\n  processSave() {\n    this.ss.presentLoading();\n    this.payload.signature = this.ss.GENERATE_SIGNATURE;\n    this.payload.street.street_id = this.ss.GENERATE_STREET_ID();\n    if(this.payload.street.gis_id === ''){\n      this.payload.street.gis_id = this.ss.GENERATE_GIS_ID();\n    }\n    this.payload.document_owner = this.user.document_owner ? this.user.document_owner : this.user._id;\n    this.payload.enumerator = {\n      id: this.user._id,\n      firstname: this.user.personal.firstname,\n      lastname: this.user.personal.lastname,\n      email: this.user.personal.email,\n      mobile: this.user.personal.mobile\n    };\n    this.geolocation.getCurrentPosition({ timeout: 30000, enableHighAccuracy: true }).then((position) => {\n      this.ss.toast('Location captured', 2000);\n      this.payload.location.coordinates = { latitude: position.coords.latitude, longitude: position.coords.longitude };\n      \n      this.store.UPDATE_RECORD('__streets__',this.payload).then(feedback => {\n        if (feedback) {\n          this.ss.dismissLoading();\n          this.ss.swalAlert('Data Service', 'Record stored successfully. <br><b>Next</b>: Add street photo', 'success');\n          this.navCtrl.pop().then(() => {\n            this.navCtrl.push('StreetPhotoPage', { data: this.payload.street.street_id });\n          });\n        } else {\n          this.ss.dismissLoading();\n          this.ss.swalAlert('Data Service', 'Storage error! Please try again.', 'error');\n        }\n      }).catch(err => {\n        this.ss.dismissLoading();\n        this.ss.swalAlert('Data Service', 'Storage error! Please try again.', 'error');\n      });\n    }).catch(err => {\n      this.ss.dismissLoading();\n      this.ss.toast('Unable to capture device current location. Pleas turn on device location access', 3000);\n    });\n   \n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/new-street/new-street.ts"],"sourceRoot":""}