{"version":3,"sources":["../../src/pages/new-property/new-property.module.ts","../../src/pages/new-property/new-property.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAyC;AACO;AACC;AAUjD,IAAa,qBAAqB;IAAlC;IAAoC,CAAC;IAAD,4BAAC;AAAD,CAAC;AAAxB,qBAAqB;IARjC,+DAAQ,CAAC;QACR,YAAY,EAAE;YACZ,sEAAe;SAChB;QACD,OAAO,EAAE;YACP,sEAAe,CAAC,QAAQ,CAAC,sEAAe,CAAC;SAC1C;KACF,CAAC;GACW,qBAAqB,CAAG;AAAH;;;;;;;;;;;;;;;;;;;;;;;;;;ACZQ;AAC0B;AACZ;AACI;AACgB;AACV;AACJ;AAO9D,IAAa,eAAe;IA0D1B,yBAAmB,OAAsB,EAAS,SAAoB,EAC7D,UAAsB,EAAU,GAAa,EAC5C,KAAY,EAAU,EAAkB,EAAU,WAAwB;QAFjE,YAAO,GAAP,OAAO,CAAe;QAAS,cAAS,GAAT,SAAS,CAAW;QAC7D,eAAU,GAAV,UAAU,CAAY;QAAU,QAAG,GAAH,GAAG,CAAU;QAC5C,UAAK,GAAL,KAAK,CAAO;QAAU,OAAE,GAAF,EAAE,CAAgB;QAAU,gBAAW,GAAX,WAAW,CAAa;QA1D7E,YAAO,GAAQ;YACpB,SAAS,EAAE,EAAE;YACb,cAAc,EAAE,EAAE;YAClB,QAAQ,EAAE;gBACR,WAAW,EAAE,EAAE;gBACf,SAAS,EAAE,EAAE;gBACb,sBAAsB,EAAE,EAAE;gBAC1B,6BAA6B,EAAE,EAAE;gBACjC,sBAAsB,EAAE,EAAE;gBAC1B,cAAc,EAAE,EAAE;gBAClB,YAAY,EAAE,EAAE;gBAChB,WAAW,EAAE,EAAE;gBACf,GAAG,EAAE,EAAE;gBACP,KAAK,EAAE,EAAE;gBACT,OAAO,EAAE,EAAE;gBACX,eAAe,EAAE,EAAE;gBACnB,aAAa,EAAE,EAAE;gBACjB,eAAe,EAAE,KAAK;gBACtB,sBAAsB,EAAE,CAAC;gBACzB,YAAY,EAAE,EAAE;gBAChB,eAAe,EAAE,EAAE;gBACnB,WAAW,EAAE,KAAK;gBAClB,aAAa,EAAE,EAAE;gBACjB,kBAAkB,EAAE,EAAE;gBACtB,gBAAgB,EAAE,CAAC;gBACnB,UAAU,EAAE,IAAI;aACjB;YACD,OAAO,EAAE;gBACP,cAAc,EAAE,EAAE;gBAClB,KAAK,EAAE,EAAE;gBACT,SAAS,EAAE,EAAE;aACd;YACD,QAAQ,EAAE;gBACR,IAAI,EAAE,OAAO;gBACb,WAAW,EAAE;oBACX,QAAQ,EAAE,CAAC;oBACX,SAAS,EAAE,CAAC;iBACb;gBACD,cAAc,EAAE,EAAE;aACnB;YACD,eAAe,EAAE,EAAE;YACnB,UAAU,EAAE;gBACV,EAAE,EAAE,EAAE;gBACN,SAAS,EAAE,EAAE;gBACb,QAAQ,EAAE,EAAE;gBACZ,KAAK,EAAE,EAAE;gBACT,SAAS,EAAE,EAAE;aACd;YACD,SAAS,EAAE,EAAE;SACd,CAAC;QAEK,kBAAa,GAAU,EAAE,CAAC;QAC1B,gBAAW,GAAU,EAAE,CAAC;QACxB,YAAO,GAAQ,EAAE,CAAC;QAMvB,IAAI,CAAC,UAAU,GAAG,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;QACxC,IAAI,CAAC,QAAQ,EAAE,CAAC;IAClB,CAAC;IAED,kCAAQ,GAAR;QAAA,iBAWC;QAVC,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,IAAI,CAAC,cAAI;YAC7B,KAAI,CAAC,IAAI,GAAG,IAAI,CAAC;YACjB,KAAI,CAAC,MAAM,EAAE,CAAC;QAChB,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,IAAI,CAAC,EAAE,CAAC,kBAAkB,EAAE,CAAC;QACtD,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC;QAC/D,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;QACnE,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,GAAG,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;QACnD,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;QACvD,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;IAC7D,CAAC;IAED,wCAAc,GAAd;IAEA,CAAC;IAED,gCAAM,GAAN;QAAA,iBAEC;QADC,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,cAAI,IAAG,YAAI,CAAC,OAAO,GAAG,IAAI,EAAnB,CAAmB,CAAC,CAAC;IAClD,CAAC;IAED,qCAAW,GAAX;QACE,EAAE,EAAC,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,YAAY;YACpC,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,cAAc;YACrC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,eAAe,CAAC,MAAM,KAAK,CAAC;YAClD,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,aAAa,CAAC,MAAM,KAAK,CAAC;YAChD,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,sBACzB,CAAC,EAAC;YACA,MAAM,CAAC,KAAK;QACd,CAAC;QAAA,IAAI,EAAC;YACJ,MAAM,CAAC,IAAI;QACb,CAAC;IACH,CAAC;IAED,8BAAI,GAAJ;QACE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC;YACxB,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,cAAc,EAAE,2CAA2C,EAAE,OAAO,CAAC,CAAC;QAC1F,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,IAAI,CAAC,WAAW,EAAE,CAAC;QACrB,CAAC;IAEH,CAAC;IAED,qCAAW,GAAX;QAAA,iBAoCC;QAnCC,IAAI,CAAC,EAAE,CAAC,cAAc,EAAE,CAAC;QACzB,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,IAAI,CAAC,EAAE,CAAC,kBAAkB,CAAC;QACpD,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,WAAW,GAAG,IAAI,CAAC,EAAE,CAAC,oBAAoB,EAAE,CAAC;QACnE,IAAI,CAAC,OAAO,CAAC,cAAc,GAAG,IAAI,CAAC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC;QAClG,IAAI,CAAC,OAAO,CAAC,UAAU,GAAG;YACxB,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG;YACjB,SAAS,EAAE,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,SAAS;YACvC,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ;YACrC,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK;YAC/B,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM;SAClC,CAAC;QACF,EAAE,EAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,sBAAsB,KAAK,EAAE,CAAC,EAAC;YACtD,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,sBAAsB,GAAG,IAAI,CAAC,EAAE,CAAC,+BAA+B,EAAE,CAAC;QAC3F,CAAC;QACD,EAAE,EAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,6BAA6B,KAAK,EAAE,CAAC,EAAC;YAC7D,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,6BAA6B,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,sBAAsB,CAAC;QACrG,CAAC;QACD,IAAI,CAAC,WAAW,CAAC,kBAAkB,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,kBAAkB,EAAE,IAAI,EAAE,CAAC,CAAC,IAAI,CAAC,UAAC,QAAQ;YAC9F,KAAI,CAAC,EAAE,CAAC,KAAK,CAAC,mBAAmB,EAAE,IAAI,CAAC,CAAC;YACzC,KAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,WAAW,GAAG,EAAE,QAAQ,EAAE,QAAQ,CAAC,MAAM,CAAC,QAAQ,EAAE,SAAS,EAAE,QAAQ,CAAC,MAAM,CAAC,SAAS,EAAE,CAAC;YACjH,KAAI,CAAC,KAAK,CAAC,aAAa,CAAC,gBAAgB,EAAC,KAAI,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,kBAAQ;gBACnE,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;oBACb,KAAI,CAAC,OAAO,EAAE,CAAC;gBACjB,CAAC;gBAAC,IAAI,CAAC,CAAC;oBACN,KAAI,CAAC,EAAE,CAAC,cAAc,EAAE,CAAC;oBACzB,KAAI,CAAC,EAAE,CAAC,SAAS,CAAC,cAAc,EAAE,kCAAkC,EAAE,OAAO,CAAC,CAAC;gBACjF,CAAC;YACH,CAAC,CAAC,CAAC,KAAK,CAAC,aAAG;gBACV,KAAI,CAAC,EAAE,CAAC,cAAc,EAAE,CAAC;gBACzB,KAAI,CAAC,EAAE,CAAC,SAAS,CAAC,cAAc,EAAE,kCAAkC,EAAE,OAAO,CAAC,CAAC;YACjF,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC,KAAK,CAAC,aAAG;YACV,KAAI,CAAC,EAAE,CAAC,cAAc,EAAE,CAAC;YACzB,KAAI,CAAC,EAAE,CAAC,KAAK,CAAC,iFAAiF,EAAE,IAAI,CAAC,CAAC;QACzG,CAAC,CAAC,CAAC;IACL,CAAC;IAGD,iCAAO,GAAP;QAAA,iBASC;QARC,IAAI,CAAC,EAAE,CAAC,cAAc,EAAE,CAAC;QACnB,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,aAAG,IAAI,UAAG,CAAC,GAAG,IAAI,KAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,sBAAsB,EAAvD,CAAuD,CAAC,CAAC;aACnG,IAAI,CAAC,gBAAM;YACV,KAAI,CAAC,EAAE,CAAC,SAAS,CAAC,cAAc,EAAE,iEAAiE,EAAE,SAAS,CAAC,CAAC;YAChH,KAAI,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC;gBACtB,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,mBAAmB,EAAE,EAAE,IAAI,EAAE,KAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC,CAAC;YACtF,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACX,CAAC;IAEH,sBAAC;AAAD,CAAC;AA9JY,eAAe;IAL3B,wEAAS,EAAE;IACX,gEAAS,CAAC;QACT,QAAQ,EAAE,mBAAmB;OACG;KACjC,CAAC;6KA2DsE;QACjD,4KAAiC;QACrC,KAAK,EAAc,KAAgD;AAkGrF;SA9JY,eAAe,gB","file":"24.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { NewPropertyPage } from './new-property';\n\n@NgModule({\n  declarations: [\n    NewPropertyPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(NewPropertyPage),\n  ],\n})\nexport class NewPropertyPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/new-property/new-property.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\nimport { Geolocation } from '@ionic-native/geolocation';\nimport { Store } from '../../app.services/store/data.store';\nimport { SharedServices } from '../../app.services/library/shared.services';\nimport { FormConfig } from '../../app.services/store/form.config';\nimport { BSNStore } from '../../app.services/store/bsn.store';\n\n@IonicPage()\n@Component({\n  selector: 'page-new-property',\n  templateUrl: 'new-property.html',\n})\nexport class NewPropertyPage {\n\n  public payload: any = {\n    record_id: '',\n    document_owner: '',\n    property: {\n      property_id: '',\n      street_id: '',\n      building_serial_number: '',\n      master_building_serial_number: '',\n      building_part_occupied: '',\n      ownership_type: '',\n      house_number: '',\n      street_name: '',\n      lga: '',\n      state: '',\n      country: '',\n      site_conditions: [],\n      building_type: [],\n      storey_building: false,\n      storey_building_floors: 0,\n      water_supply: [],\n      refuse_disposal: '',\n      has_signage: false,\n      gate_house_id: '',\n      generator_house_id: '',\n      number_of_entity: 1,\n      accessible: true\n    },\n    contact: {\n      contact_person: '',\n      email: '',\n      telephone: ''\n    },\n    location: {\n      type: 'Point',\n      coordinates: {\n        latitude: 0,\n        longitude: 0\n      },\n      whatthreewords: ''\n    },\n    property_photos: [],\n    enumerator: {\n      id: '',\n      firstname: '',\n      lastname: '',\n      email: '',\n      telephone: ''\n    },\n    signature: ''\n  };\n\n  public nigeriaStates: any[] = [];\n  public stateCities: any[] = [];\n  public bsnList: any[]=[];\n  private user: any;\n  private streetData: any;\n  constructor(public navCtrl: NavController, public navParams: NavParams, \n    public formConfig: FormConfig, private bsn: BSNStore,\n    private store: Store, private ss: SharedServices, private geolocation: Geolocation) {\n    this.streetData = navParams.get('data');\n    this.dataInit();\n  }\n\n  dataInit() {\n    this.store.GET_USER().then(data=>{\n      this.user = data;\n      this.getBSN();\n    });\n    this.payload.record_id = this.ss.GENERATE_RECORD_ID();\n    this.payload.property.street_id = this.streetData['street_id'];\n    this.payload.property.street_name = this.streetData['street_name'];\n    this.payload.property.lga = this.streetData['lga'];\n    this.payload.property.state = this.streetData['state'];\n    this.payload.property.country = this.streetData['country'];\n  }\n\n  ionViewDidLoad() {\n\n  }\n\n  getBSN(){\n    this.bsn.GET().then(docs=> this.bsnList = docs);\n  }\n\n  isFormValid(): boolean {\n    if(!this.payload.property.house_number || \n      !this.payload.property.ownership_type || \n      this.payload.property.site_conditions.length === 0 || \n      this.payload.property.building_type.length === 0 || \n      !this.payload.property.building_part_occupied\n    ){\n      return false\n    }else{\n      return true\n    }\n  }\n\n  save() {\n    if (!this.isFormValid()) {\n      this.ss.swalAlert('Data Service', 'All fields are required. Please try again', 'error');\n    } else {\n      this.processSave();\n    }\n\n  }\n\n  processSave() {\n    this.ss.presentLoading();\n    this.payload.signature = this.ss.GENERATE_SIGNATURE;\n    this.payload.property.property_id = this.ss.GENERATE_PROPERTY_ID();\n    this.payload.document_owner = this.user.document_owner ? this.user.document_owner : this.user._id;\n    this.payload.enumerator = {\n      id: this.user._id,\n      firstname: this.user.personal.firstname,\n      lastname: this.user.personal.lastname,\n      email: this.user.personal.email,\n      mobile: this.user.personal.mobile\n    };\n    if(this.payload.property.building_serial_number === ''){\n      this.payload.property.building_serial_number = this.ss.GENERATE_BUILDING_SERIAL_NUMBER();\n    }\n    if(this.payload.property.master_building_serial_number === ''){\n      this.payload.property.master_building_serial_number = this.payload.property.building_serial_number;\n    }\n    this.geolocation.getCurrentPosition({ timeout: 30000, enableHighAccuracy: true }).then((position) => {\n      this.ss.toast('Location captured', 2000);\n      this.payload.location.coordinates = { latitude: position.coords.latitude, longitude: position.coords.longitude };\n      this.store.UPDATE_RECORD('__properties__',this.payload).then(feedback => {\n        if (feedback) {\n          this.success();\n        } else {\n          this.ss.dismissLoading();\n          this.ss.swalAlert('Data Service', 'Storage error! Please try again.', 'error');\n        }\n      }).catch(err => {\n        this.ss.dismissLoading();\n        this.ss.swalAlert('Data Service', 'Storage error! Please try again.', 'error');\n      });\n    }).catch(err => {\n      this.ss.dismissLoading();\n      this.ss.toast('Unable to capture device current location. Pleas turn on device location access', 3000);\n    });\n  }\n\n\n  success(){\n    this.ss.dismissLoading();\n          this.bsn.UPDATE(this.bsnList.filter(doc => doc.bsn != this.payload.property.building_serial_number))\n          .then(status=>{\n            this.ss.swalAlert('Data Service', 'Record stored successfully. <br><b>Next</b>: Add property photo', 'success');\n            this.navCtrl.pop().then(() => {\n              this.navCtrl.push('PropertyPhotoPage', { data: this.payload.property.property_id });\n            });\n          });\n  }\n\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/new-property/new-property.ts"],"sourceRoot":""}